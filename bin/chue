#!/bin/env bash

cd ~/etsi

DIR="schemes/*/"
DIRS=($DIR)
FIRST=`echo "${DIRS[@]:0:1}" | awk -F'/' '{print $2}' -`

schemes () {
  for dir in $DIR; do
    dir=`echo $dir | awk -F'/' '{print $2}' -`
    echo "- $dir"
  done
}

containsElement () {
  local e

  for e in "${@:2}"; do
    [[ "$e" == "$1" ]] &&
      return 0
  done

  return 1
}

ask() {
  read -p "Choose a colorscheme. Available options are:

$(schemes)

($FIRST) > " choice

  if [[ -z "$choice" ]]; then
    echo -e "\nYou chose ${FIRST}"
    return 0
  fi

  check="schemes/${choice}/"

  containsElement "${check}" "${DIRS[@]}"

  if [[ $? -eq 1 ]]; then
    echo -e "\nERROR: There is no theme '${choice}', try again!\n"
    ask
  else
    echo -e "\nYou chose ${choice}"
    return 0
  fi
}

ask
